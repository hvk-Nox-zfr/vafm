<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Connexion Admin</title>
</head>
<body>

<h2>Connexion Admin</h2>

<form id="login-form">
    <input type="text" id="username" placeholder="Identifiant" required>
    <input type="password" id="password" placeholder="Mot de passe" required>
    <button type="submit">Se connecter</button>
</form>

<script>
// Liste des comptes
const USERS = [
    { username: "hugo", passwordHash: "144b08ff1fa44233dc1c11016017661a76521d67ba82267e58bb03a53a45fbb2" },
    { username: "thomas", passwordHash: "76624cb8f59de6f87cb1ec8253a33a59247530f2773c2db1eede4ea88d2fe9f9" }
];

// Fonction de hash SHA-256
async function sha256(message) {
    const msgBuffer = new TextEncoder().encode(message);
    const hashBuffer = await crypto.subtle.digest("SHA-256", msgBuffer);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    return hashArray.map(b => b.toString(16).padStart(2, "0")).join("");
}

document.getElementById("login-form").addEventListener("submit", async (e) => {
    e.preventDefault();

    const user = document.getElementById("username").value.toLowerCase();
    const pass = document.getElementById("password").value;

    const hash = await sha256(pass);

    const account = USERS.find(u => u.username === user);

    if (!account) {
        alert("Utilisateur inconnu");
        return;
    }

    if (hash !== account.passwordHash) {
        alert("Mot de passe incorrect");
        return;
    }

    // Connexion OK
    localStorage.setItem("admin_logged", "true");
    localStorage.setItem("admin_user", user);

    window.location.href = "index.html";
});
</script>

</body>
</html>